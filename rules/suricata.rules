# alert http any any -> any any (http.user_agent; to_lowercase; content:"windows1\; u\; windows nt 5.1\;"; sid:1;)
# alert http any any -> any any (http.response_body; to_uppercase; content:"<HTML>"; sid:1000001;)

# a1 && a2 && (b || c)
# a1: http.user_agent == "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.6) Gecko/20040113"
# a2: http.accept == ".*text.*html.*plain"
# b: http.host == "www.google.com"
# c: http.host == "www.ethereal.com"
# 方案1 a1 && a2 && b || a1 && a2 && c ，验证a1和a2是否会被重复匹配
# alert http any any -> any any (http.user_agent; content:"Mozilla/5.0"; bsize: <=600; http.accept; pcre: "/.*text.*html.*plain/i"; http.host; content: "www.google.com"; sid:1000001;)
# alert http any any -> any any (http.user_agent; content:"Mozilla/5.0"; bsize: <=600; http.accept; pcre: "/.*text.*html.*plain/i"; http.host; content: "www.ethereal.com"; sid:1000002;)

# alert http any any -> any any (http.uri; byte_test:4,=,0x6e6c6f61,4; sid:1000002;)
# alert udp any any -> any any (byte_extract:1,48,offset_var; byte_test:2,=,0x7007,offset_var,little; sid:1000002;)
# alert http any any -> any any (http.uri; content: "download.html"; lua:test_http.lua; sid:1000002;)
# alert http any any -> any any (http.uri; content: "down"; content: "html"; sid:1000002;)
alert http any any -> any any (http.uri; content: "download.html"; lua:test_http.lua; time:<1751524260; sid:1000002;)
